function init(){load(path);$("#player").bind("ended",next);$("#addall").click(addAll);$("#next").click(next)}function load(e){var t=root+e.join("/");if(typeof cache[t]!="undefined"){populate(cache[t]);return}$.ajax({url:t,dataType:"json",success:function(e){populate(e);cache[t]=e}})}function populate(e){function n(e,n){if(n.Name[0]=="."||n.Name[0]==":")return;var r=n.IsDir;var i=r?"dir":"file";n.Path=path.join("/");$("<a></a>").text(n.Name).data("file",n).addClass(i).appendTo(t).click(r?clickDir:clickFile)}var t=$("#browser").empty();e.sort(function(e,t){e=e.Name.toLowerCase();t=t.Name.toLowerCase();if(e>t)return 1;if(e<t)return-1;return 0});t.append(up());$.each(e,n)}function up(){return $('<a class="dir">..</a>').click(function(){path.pop();load(path)})}function clickDir(e){path.push($(e.target).data("file").Name);load(path)}function clickFile(e){addToPlaylist($(e.target).data("file"))}function addToPlaylist(e){var t=$("#playlist");var n=t.find("a").length==0;var r=$("<a></a>").text(e.Name).data("file",e).appendTo(t).click(function(e){play(e.target)});if(n)r.click()}function addAll(){$("#browser a.file").each(function(e,t){addToPlaylist($(t).data("file"))})}function play(e){var t=$(e).data("file").Name;var n=$(e).data("file").Path;var r=root+n+"/"+t;$("#playlist a").removeClass("playing");$(e).addClass("playing");$("#player").attr("src",r)}function next(){var e=$("#playlist a.playing").next();if(e.length)play(e)}var root="/f/";var path=[];var cache={};google.load("jquery","1.4.2");google.setOnLoadCallback(init)